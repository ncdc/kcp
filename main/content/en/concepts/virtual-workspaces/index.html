<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>Virtual Workspaces - kcp</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../../../../css/version-select.css" rel="stylesheet">

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">kcp</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Content <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">En</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../" class="dropdown-item"><img src="logo.png" style="vertical-align: middle;" /> kcp Documentation</a>
</li>
            
<li>
    <a href="../../CONTRIBUTING/" class="dropdown-item">Contributing to kcp</a>
</li>
            
<li>
    <a href="../../GOALS/" class="dropdown-item">Project Goals</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Concepts</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../" class="dropdown-item">Terminology for kcp</a>
</li>
            
<li>
    <a href="../authorization/" class="dropdown-item">Authorization</a>
</li>
            
<li>
    <a href="../cache-server/" class="dropdown-item">Cache Server</a>
</li>
            
<li>
    <a href="../cluster-mapper/" class="dropdown-item">Cluster Mapper</a>
</li>
            
<li>
    <a href="../kubectl-kcp-plugin/" class="dropdown-item">Kubectl kcp plugin</a>
</li>
            
<li>
    <a href="../locations-and-scheduling/" class="dropdown-item">Placement, Locations and Scheduling</a>
</li>
            
<li>
    <a href="../quickstart-tenancy-and-apis/" class="dropdown-item">Quickstart: Tenancy and APIs</a>
</li>
            
<li>
    <a href="../storage/" class="dropdown-item">Storage and stateful applications</a>
</li>
            
<li>
    <a href="../syncer/" class="dropdown-item">Registering Kubernetes Clusters using syncer</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Virtual Workspaces</a>
</li>
            
<li>
    <a href="../workspaces/" class="dropdown-item">Workspaces</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Developers</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../developers/" class="dropdown-item">Developers</a>
</li>
            
<li>
    <a href="../developers/controllers/" class="dropdown-item">Writing kcp-aware controllers</a>
</li>
            
<li>
    <a href="../developers/library-usage/" class="dropdown-item">Using kcp as a library</a>
</li>
            
<li>
    <a href="../developers/releasing/" class="dropdown-item">Publishing a new kcp release</a>
</li>
            
<li>
    <a href="../developers/replicate-new-resource/" class="dropdown-item">Adding a new resource to the cache server and replication controller</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Investigations</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../investigations/logical-clusters/" class="dropdown-item">Logical clusters</a>
</li>
            
<li>
    <a href="../investigations/minimal-api-server/" class="dropdown-item">Minimal API Server</a>
</li>
            
<li>
    <a href="../investigations/self-service-policy/" class="dropdown-item">Self-service policy</a>
</li>
            
<li>
    <a href="../investigations/transparent-multi-cluster/" class="dropdown-item">Transparent multi-cluster</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Reference</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Cli</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../reference/cli/kcp/" class="dropdown-item">kcp</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_bind/" class="dropdown-item">kcp bind</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_bind_apiexport/" class="dropdown-item">kcp bind apiexport</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_bind_compute/" class="dropdown-item">kcp bind compute</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_claims/" class="dropdown-item">kcp claims</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_claims_get/" class="dropdown-item">kcp claims get</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_claims_get_apibinding/" class="dropdown-item">kcp claims get apibinding</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_crd/" class="dropdown-item">kcp crd</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_crd_snapshot/" class="dropdown-item">kcp crd snapshot</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workload/" class="dropdown-item">kcp workload</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workload_cordon/" class="dropdown-item">kcp workload cordon</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workload_drain/" class="dropdown-item">kcp workload drain</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workload_sync/" class="dropdown-item">kcp workload sync</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workload_uncordon/" class="dropdown-item">kcp workload uncordon</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workspace/" class="dropdown-item">kcp workspace</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workspace_create-context/" class="dropdown-item">kcp workspace create-context</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workspace_create/" class="dropdown-item">kcp workspace create</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workspace_current/" class="dropdown-item">kcp workspace current</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workspace_tree/" class="dropdown-item">kcp workspace tree</a>
</li>
            
<li>
    <a href="../../reference/cli/kcp_workspace_use/" class="dropdown-item">kcp workspace use</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Crd</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../reference/crd/apibindings.apis.kcp.io/" class="dropdown-item">APIBinding</a>
</li>
            
<li>
    <a href="../../reference/crd/apiexportendpointslices.apis.kcp.io/" class="dropdown-item">APIExportEndpointSlice</a>
</li>
            
<li>
    <a href="../../reference/crd/apiexports.apis.kcp.io/" class="dropdown-item">APIExport</a>
</li>
            
<li>
    <a href="../../reference/crd/apiresourceimports.apiresource.kcp.io/" class="dropdown-item">APIResourceImport</a>
</li>
            
<li>
    <a href="../../reference/crd/apiresourceschemas.apis.kcp.io/" class="dropdown-item">APIResourceSchema</a>
</li>
            
<li>
    <a href="../../reference/crd/locations.scheduling.kcp.io/" class="dropdown-item">Location</a>
</li>
            
<li>
    <a href="../../reference/crd/logicalclusters.core.kcp.io/" class="dropdown-item">LogicalCluster</a>
</li>
            
<li>
    <a href="../../reference/crd/negotiatedapiresources.apiresource.kcp.io/" class="dropdown-item">NegotiatedAPIResource</a>
</li>
            
<li>
    <a href="../../reference/crd/partitions.topology.kcp.io/" class="dropdown-item">Partition</a>
</li>
            
<li>
    <a href="../../reference/crd/partitionsets.topology.kcp.io/" class="dropdown-item">PartitionSet</a>
</li>
            
<li>
    <a href="../../reference/crd/placements.scheduling.kcp.io/" class="dropdown-item">Placement</a>
</li>
            
<li>
    <a href="../../reference/crd/shards.core.kcp.io/" class="dropdown-item">Shard</a>
</li>
            
<li>
    <a href="../../reference/crd/synctargets.workload.kcp.io/" class="dropdown-item">SyncTarget</a>
</li>
            
<li>
    <a href="../../reference/crd/workspaces.tenancy.kcp.io/" class="dropdown-item">Workspace</a>
</li>
            
<li>
    <a href="../../reference/crd/workspacetypes.tenancy.kcp.io/" class="dropdown-item">WorkspaceType</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Enhancements <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../enhancements/0001_project_enhancements/" class="dropdown-item">0001: Project process refinement for 2023</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../syncer/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../workspaces/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#examples" class="nav-link">Examples</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#faq" class="nav-link">FAQ</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>Virtual workspaces are proxy-like apiservers under a custom URL that provide some computed view of real workspaces.</p>
<h2 id="examples">Examples</h2>
<ol>
<li>when the user does <code>kubectl get workspaces</code> only workspaces are shown that the user has access to.</li>
<li>controllers should not be able to directly access customer workspaces. They should only be able to access the objects that are connected to their provided APIs. In <a href="https://www.youtube.com/watch?v=Ca3vh3lS6YI&amp;t=1280s">April 19's community call this virtual workspace was showcased</a>, developed during v0.4 phase.</li>
<li>if we keep the initializer model with <code>WorkspaceType</code>, there must be a virtual workspace for the "workspace type owner" that gives access to initializing workspaces.</li>
<li>the syncer will get a virtual workspace view of the workspaces it syncs to physical clusters. That view will have transformed objects potentially, especially deployment-splitter-like transformations will be implemented within a virtual workspace, transparently applied from the point of view of the syncer.</li>
</ol>
<h2 id="faq">FAQ</h2>
<ul>
<li><strong>Can we use go clients to watch resources on a virtual workspace?</strong> Absolutely. From the point of view of the controllers it is just a normal (client) URL. So one can use client-go informers (or controller-runtime) to watch the objects in a virtual workspace.</li>
</ul>
<p>!!! note
    A normal service account lives in just ONE workspace and can only access its own workspace. So in order to use a service account for accessing cross-workspace data (and that's what is necessary in example 2 and 3 at least), we need a virtual workspace to add the necessary authz.</p>
<ul>
<li><strong>Are virtual workspaces read-only?</strong> No, they are not necessarily. Some are, some are not. The controller view virtual workspace will be writable, as well as the syncer virtual workspace.</li>
<li><strong>Do service teams have to write their own virtual workspace?</strong> Not for the standard cases as described above. There might be cases in the future where service teams provide their own virtual workspace for some very special purpose access patterns. But we are not there yet.</li>
<li><strong>Where does the developer get the URL from of the virtual workspace?</strong> The URLs will be "published" in some object status. E.g. APIExport.status will have a list of URLs that controllers have to connect to (example 2). Similarly, SyncTarget.status will have URLs for the syncer virtual workspaces, etc. We might do the same in WorkspaceType.status (example 3).</li>
<li><strong>Will there be multiple virtual workspace URLs my controller has to watch?</strong> Yes, as soon as we add sharding, it will become a list. So it might be that 1000 tenants are accessible under one URL, the next 1000 under another one, and so on. The controllers have to watch the mentioned URL lists in status of objects and start new instances (either with their own controller sharding eventually, or just in process with another go routine).</li>
<li><strong>Show me the code.</strong> The stock kcp virtual workspaces are in <a href="../pkg/virtual"><code>pkg/virtual</code></a>.</li>
<li><strong>Who runs the virtual workspaces?</strong> The stock kcp virtual workspaces will be run through <code>kcp start</code> in-process. The personal workspace one (example 1) can also be run as its own process and the kcp apiserver will forward traffic to the external address. There might be reasons in the future like scalability that the later model is preferred. For the clients of virtual workspaces that has no impact. They are supposed to "blindly" use the URLs published in the API objects' status. Those URLs might point to in-process instances or external addresses depending on deployment topology.</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="../../../../search/main.js" defer></script>
        <script src="../../../../js/version-select.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
